define(["./_baseToString","./_castSlice","./isObject","./isRegExp","./_reHasComplexSymbol","./_stringSize","./_stringToArray","./toInteger","./toString"],function(e,r,i,n,t,s,a,o,l){function f(f,u){var h=c,d=v;if(i(u)){var p="separator"in u?u.separator:p;h="length"in u?o(u.length):h,d="omission"in u?e(u.omission):d}f=l(f);var S=f.length;if(t.test(f)){var _=a(f);S=_.length}if(h>=S)return f;var b=h-s(d);if(1>b)return d;var m=_?r(_,0,b).join(""):f.slice(0,b);if(p===g)return m+d;if(_&&(b+=m.length-b),n(p)){if(f.slice(b).search(p)){var I,O=m;for(p.global||(p=RegExp(p.source,l(x.exec(p))+"g")),p.lastIndex=0;I=p.exec(O);)var j=I.index;m=m.slice(0,j===g?b:j)}}else if(f.indexOf(e(p),b)!=b){var y=m.lastIndexOf(p);y>-1&&(m=m.slice(0,y))}return m+d}var g,c=30,v="...",x=/\w*$/;return f});